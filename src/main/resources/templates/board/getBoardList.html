<!DOCTYPE html>
<html lang="ko"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/layout}">
	 
	 <head>
		 <th:block layout:fragment="script">
			 <script th:inline="javascript">
				 const pageNumber = /*[[${pageDTO.cri.pageNum}]]*/;
				 const startNum = /*[[${pageDTO.cri.startNum}]]*/;
				 $(function() {
					 $(".pagination a").on("click", function(e) {
						 e.preventDefault();
						 
						 $("input[name='pageNum']").val($(this).attr("data-pagingPage"));
						 $("#searchForm").submit();
					 })
					 
					 $("#btnSearch").on("click", function() {
						 $("#input[name='pageNum']").val(1);
						 $("#searchForm").submit();
					 })
					 console.log("startNum: " + startNum);
					 console.log("pageNum: " + pageNumber);
					 
				 });
			 </script>
		 </th:block>
		 <th:block layout:fragment="css">
			 <link rel="stylesheet" th:href="@{/css/getBoardList.css}"/>
			 <link rel="stylesheet" th:href="@{/css/style.css}"/>
			 <style>				 
				 .wrapper {
					 width: 100%;
					 text-align: center;
					 height: 450px;
				 }
				 
				 .tableWrap {
					 display: inline-block;
				 }
				 
				 #boardTable {
					 width: 950px;
				 }
				 
				 .boardNo {
					 width: 7%;
				 }
				 
				 .category {
					 width: 7%;
				 }
				 
				 .boardTitle {
					 width: 35%;
				 }
				 
				 .fileCnt {
					 width: 9%;
				 }
				 
				 .boardWriter {
					 width: 20%;
				 }
				 
				 .boardRegdate {
					 width: 15%;
				 }
				 
				 .boardCnt {
					 width: 7%;
				 }
				 
				 .numPage {
					 text-align: center;
					 width: 100%;
				 }
				 
				 .pagination {
					 width: 100%;
					 list-style: none;
					 margin-left: 300px;
				 }
				 
				 .pagination a {
					 color: black;
					 text-decoration: none;
				 }
				 
				 .pagination_button {
					 float: left;
					 margin-left: 5px;
				 }
				 
				 .pagination li {
					 margin: -20px 0 20px 10px;
				 }
				 
				 .floor {
					 clear: both;
				 }
			 </style>
		 </th:block>
	 </head>
	 <body
		 <div layout:fragment="content">
			 <div class="wrapper">
				 <div class="topMent">
					 <h3>게시글 목록</h3>
					 <a th:href="@{/board/insertBoard}" id="btnWrite">새 글 작성</a>					 
				 </div>
				 <div class="tableWrap">
					 <form id="searchForm" action="/board/boardList" method="post">
						 <input type="hidden" name="pageNum" th:value="${pageDTO.cri.pageNum}">
						 <input type="hidden" name="amount" th:value="${pageDTO.cri.amount}"> 
						 <table>
							 <tr>
								 <td>
									 <select name="searchCondition">
										 <option value="ALL" th:selected="${searchCondition == 'ALL'}">전체</option>
										 <option value="TITLE" th:selected="${searchCondition == 'TITLE'}">제목</option>
										 <option value="CONTENT" th:selected="${searchCondition == 'CONTENT'}">내용</option>
										 <option value="WRITER" th:selected="${searchCondition == 'WRITER'}">작성자</option>
									 </select>
									 <input type="text" name="searchKeyword" th:value="${searchKeyword}">
									 <button type="button" id="btnSearch">검색</button>
								 </td>
							 </tr>
						 </table>
					 </form>
					 <table id="boardTable">
						 <tr>
							 <th class="boardNo">글 번호</th>
							 <th class="category">글 종류</th>
							 <th class="boardTitle">글 제목</th>
							 <th class="fileCnt">첨부파일(개수)</th>
							 <th class="boardWriter">작성자</th>
							 <th class="boardRegdate">작성일</th>
							 <th class="boardCnt">조회수</th>
						 </tr>
						 <tr th:each="board: ${getBoardList}">
							 <td th:text="${board.boardNo}"></td>
							 <td th:if="${board.cateNo == 0}">공지</td>
							 <td th:if="${board.cateNo == 1}">뉴스</td>
							 <td th:if="${board.cateNo == 2}">유머</td>
							 <td>
								 <a th:text="${board.boardTitle}" th:href="@{/board/updateBoardCnt/{boardNo} (boardNo=${board.boardNo})}"></a>
							 </td>
							 <td th:text="${board.fileNoCnt}"></td>
							 <td th:if="${board.boardPw == null && board.userRole != 'ADMIN'}" th:text="${board.boardWriter}"></td>
							 <td th:if="${board.boardPw != null}" th:text="${'[비회원] ' + board.boardWriter}"></td>
							 <td th:if="${board.userRole == 'ADMIN'}" th:text="${'[관리자] ' + board.boardWriter}"></td>
							 <td th:text="${board.boardRegdate eq null ? '' : #strings.substring(board.boardRegdate, 0, 10)}"></td>
							 <td th:text="${board.boardCnt}"></td>
						 </tr>
					 </table>
					 <br/>
					 <div class="numPage">
						 <ul class="pagination" th:if="${getBoardList.size > 0}">
							 <li th:if="${pageDTO.prev}" class="pagination_button btnFirst">
								 <a href="1" class="btnPage" th:attr="data-pagingPage=1">처음으로</a>
							 </li>
							 <li th:if="${pageDTO.prev}" class="pagination_button btnPrev">
								 <a th:href="@{'/board/boardList?page=' + ${pageDTO.cri.pageNum - 1}}"
								 	class="btnPage" th:attr="data-pagingPage=${pageDTO.cri.pageNum - 1}">이전</a>
							 </li>
							 <li th:each="page : ${#numbers.sequence(pageDTO.startPage, pageDTO.endPage)}" class="pagination_button">
								 <a th:href="@{'/board/boardList?page=' + ${page}}" th:text="${page}"
								 	class="btnPage" th:attr="data-pagingPage=${page}"></a>
							 </li>
							 <li th:if="${pageDTO.next}" class="pagination_button">
								 <a th:href="@{'/board/boardList?page=' + ${pageDTO.cri.pageNum + 1}}"
								 	class="btnPage" th:attr="data-pagingPage=${pageDTO.cri.pageNum + 1}">다음</a>
							 </li>	
							 <li th:if="${pageDTO.next}" class="pagination_button">
								 <a th:href="@{'/board/boardList?page=' + ${pageDTO.endPage}}"
								 	class="btnPage" th:attr="data-pagingPage=${pageDTO.endPage}">맨 끝으로</a>
							 </li>				 
						 </ul>
					 </div> 
				 </div>
				 <div class="excelDown">
					 <a href="@{'/board/excelDown'}" class="btnExcel" target="_blank" id="excelDown">엑셀 다운로드</a>
				 </div>
				 
				 <br class="floor"/>
			 </div>
		 </div>
	 </body>
</html>